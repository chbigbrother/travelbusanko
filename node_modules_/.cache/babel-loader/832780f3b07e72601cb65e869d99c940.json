{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\PKNU\\\\Documents\\\\GitHub\\\\travelbusanko\\\\travelbusanko\\\\src\\\\components\\\\BlogList.js\",\n    _s = $RefreshSig$();\n\nimport axios from 'axios';\nimport { useState, useEffect } from 'react'; //import { Link } from 'react-router-dom';\n\nimport Card from '../components/Card';\nimport { useHistory } from 'react-router'; //import  LoadingSpinner  from '../components/LoadingSpinner';\n\nimport { bool } from 'prop-types';\nimport Pagination from './Pagination'; //import Pagination2 from './Pagination2';\n\nimport LoadingSpinner from './LoadingSpinner';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst BlogList = _ref => {\n  _s();\n\n  let {\n    isAdmin\n  } = _ref;\n  const url = \"http://travelbusanko.com\";\n  const history = useHistory();\n  const [posts, setPosts] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [currentPage, setCurrentPage] = useState(1);\n  const [numberOfPosts, setNumberOfPosts] = useState(0);\n  const [numberOfPages, setNumberOfPages] = useState(0);\n  const limit = 5;\n  useEffect(() => {\n    setNumberOfPages(Math.ceil(numberOfPosts / limit));\n  }, [numberOfPosts]);\n\n  const getPosts = function () {\n    let page = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n    setCurrentPage(page);\n    let params = {\n      _page: page,\n      _limit: limit\n    };\n\n    if (!isAdmin) {\n      params = { ...params,\n        publish: true\n      };\n      console.log(params);\n    } //axios.get('http://localhost:5000/board_test', {\n    // axios.get( url +'/board_test?_page=&{page}&_limit={limit}')\n\n\n    axios.get(url + '/board_test', {\n      params\n    }).then(res => {\n      //setNumberOfPosts(res.headers['x-total-count']); \n      //console.log(params._limit);\n      //console.log(res.data);\n      setNumberOfPosts(res.data.length);\n      setPosts(res.data);\n      setLoading(false);\n    });\n  };\n\n  const deleteBlog = (e, id) => {\n    e.stopPropagation(); // 상위계층의 클릭 이벤트를 막아줌(버블링을 막음)\n    //console.log('delete blog');\n    //console.log({id});      \n    //axios.delete(url + \"/board_test\", {id}).then(()=>{\n\n    axios.delete(url + `/board_test/${id}`).then(() => {\n      setPosts(prevPosts => prevPosts.filter(post => post.id !== id));\n    });\n  };\n\n  useEffect(() => {\n    getPosts();\n  }, []);\n\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(LoadingSpinner, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 9\n    }, this);\n  }\n\n  if (posts.length === 0) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \" No blog posts found \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 17\n    }, this);\n  }\n\n  const renderBlogList = () => {\n    return posts.map(post => {\n      return /*#__PURE__*/_jsxDEV(Card, {\n        title: post.title,\n        onClick: () => history.push(`/blogs/${post.id}`),\n        children: isAdmin ? /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn btn-danger btn-sm\",\n            onClick: e => deleteBlog(e, post.id)\n            /* onClick = {(e) => {\r\n            e.stopPropagation();\r\n            console.log('HHS')\r\n            }} */\n            ,\n            children: \"  Delete\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 86,\n            columnNumber: 21\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 29\n        }, this) : null\n      }, post.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 17\n      }, this);\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [renderBlogList(), numberOfPages > 1 && /*#__PURE__*/_jsxDEV(Pagination, {\n      currentPage: currentPage,\n      numberOfPages: numberOfPages,\n      onClick: getPosts\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 30\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 100,\n    columnNumber: 5\n  }, this);\n};\n\n_s(BlogList, \"U/hX7Q39+YZ3chzykjO6r1NBAvc=\", false, function () {\n  return [useHistory];\n});\n\n_c = BlogList;\nBlogList.propTypes = {\n  isAdmin: bool\n};\nBlogList.defaultProps = {\n  isAdmin: false\n};\nexport default BlogList;\n\nvar _c;\n\n$RefreshReg$(_c, \"BlogList\");","map":{"version":3,"names":["axios","useState","useEffect","Card","useHistory","bool","Pagination","LoadingSpinner","BlogList","isAdmin","url","history","posts","setPosts","loading","setLoading","currentPage","setCurrentPage","numberOfPosts","setNumberOfPosts","numberOfPages","setNumberOfPages","limit","Math","ceil","getPosts","page","params","_page","_limit","publish","console","log","get","then","res","data","length","deleteBlog","e","id","stopPropagation","delete","prevPosts","filter","post","renderBlogList","map","title","push","propTypes","defaultProps"],"sources":["C:/Users/PKNU/Documents/GitHub/travelbusanko/travelbusanko/src/components/BlogList.js"],"sourcesContent":["import axios from 'axios';\r\nimport { useState, useEffect } from 'react';\r\n//import { Link } from 'react-router-dom';\r\nimport Card from '../components/Card';\r\nimport { useHistory } from 'react-router';\r\n//import  LoadingSpinner  from '../components/LoadingSpinner';\r\nimport { bool } from 'prop-types';\r\nimport Pagination from './Pagination';\r\n//import Pagination2 from './Pagination2';\r\nimport LoadingSpinner  from './LoadingSpinner';\r\n\r\nconst BlogList = ({ isAdmin }) => {\r\n\r\n    const url = \"http://travelbusanko.com\"; \r\n    const history = useHistory();\r\n    const [posts, setPosts] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [currentPage, setCurrentPage] = useState(1);\r\n    const [numberOfPosts, setNumberOfPosts] = useState(0);\r\n    const [numberOfPages, setNumberOfPages] = useState(0);\r\n    const limit = 5;\r\n\r\n    useEffect(()=> {\r\n        setNumberOfPages(Math.ceil(numberOfPosts/limit));\r\n    }, [numberOfPosts]);\r\n\r\n    const getPosts = (page = 1) =>{\r\n        setCurrentPage(page);\r\n        let params = { \r\n            _page : page,\r\n            _limit : limit         \r\n        }\r\n  \r\n        if(!isAdmin){\r\n            params={...params, publish:true};\r\n            console.log(params);\r\n        }\r\n       \r\n        \r\n        //axios.get('http://localhost:5000/board_test', {\r\n        // axios.get( url +'/board_test?_page=&{page}&_limit={limit}')\r\n         axios.get( url +'/board_test', {       \r\n                 params                   \r\n         }).then((res) => {                    \r\n            //setNumberOfPosts(res.headers['x-total-count']); \r\n            //console.log(params._limit);\r\n            //console.log(res.data);\r\n            setNumberOfPosts(res.data.length);            \r\n            setPosts(res.data);\r\n            setLoading(false);\r\n        })\r\n    }\r\n\r\n    const deleteBlog = (e, id) => {\r\n      e.stopPropagation(); // 상위계층의 클릭 이벤트를 막아줌(버블링을 막음)\r\n      //console.log('delete blog');\r\n      //console.log({id});      \r\n      //axios.delete(url + \"/board_test\", {id}).then(()=>{\r\n       axios.delete(url + `/board_test/${id}`).then(()=>{\r\n        setPosts(prevPosts => prevPosts.filter(post => post.id !== id)\r\n        )\r\n        }); \r\n    };\r\n    \r\n    useEffect(()=>{\r\n        getPosts();\r\n    }, []); \r\n\r\n    if(loading ){\r\n        return (\r\n        <LoadingSpinner />\r\n        )\r\n    } \r\n    if (posts.length === 0) {\r\n        return (<div> No blog posts found </div>)\r\n    }\r\n\r\n    const renderBlogList= ()=>{\r\n        return posts.map(post => {       \r\n            return (\r\n                <Card key={post.id} \r\n                title={post.title} \r\n                onClick={ () => history.push(`/blogs/${post.id}`)} \r\n                >     \r\n                {isAdmin ? (<div>\r\n                    <button className=\"btn btn-danger btn-sm\"\r\n                    onClick={(e) =>  deleteBlog(e, post.id) }\r\n                    /* onClick = {(e) => {\r\n                    e.stopPropagation();\r\n                    console.log('HHS')\r\n                    }} */\r\n                    >  Delete\r\n                    </button>\r\n                </div>) : null}\r\n                </Card>    \r\n            ); \r\n        })    \r\n    }\r\n    return (\r\n    <div>\r\n       { renderBlogList() } \r\n     \r\n       {numberOfPages > 1 && <Pagination\r\n          currentPage= {currentPage} \r\n          numberOfPages = {numberOfPages} \r\n          \r\n          onClick={getPosts} \r\n        />}      \r\n    </div>\r\n    )\r\n};\r\n\r\nBlogList.propTypes = {\r\n  isAdmin: bool\r\n}\r\nBlogList.defaultProps = {\r\n  isAdmin: false\r\n};\r\nexport default BlogList;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}