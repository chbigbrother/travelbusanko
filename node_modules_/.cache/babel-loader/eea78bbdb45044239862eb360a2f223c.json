{"ast":null,"code":"import _objectSpread from\"C:/Users/PKNU/Documents/GitHub/travelbusanko/travelbusanko/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/PKNU/Documents/GitHub/travelbusanko/travelbusanko/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import axios from'axios';import{useState,useEffect}from'react';//import { Link } from 'react-router-dom';\nimport Card from'../components/Card';import{useHistory}from'react-router';//import  LoadingSpinner  from '../components/LoadingSpinner';\nimport Pagination from'./Pagination';//import Pagination2 from './Pagination2';\nimport LoadingSpinner from'./LoadingSpinner';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var BlogList=function BlogList(_ref){var isAdmin=_ref.isAdmin;var url=\"http://travelbusanko.com\";var history=useHistory();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),posts=_useState2[0],setPosts=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];var _useState5=useState(1),_useState6=_slicedToArray(_useState5,2),currentPage=_useState6[0],setCurrentPage=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),numberOfPosts=_useState8[0],setNumberOfPosts=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),numberOfPages=_useState10[0],setNumberOfPages=_useState10[1];var limit=5;useEffect(function(){setNumberOfPages(Math.ceil(numberOfPosts/limit));},[numberOfPosts]);var getPosts=function getPosts(){var page=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;setCurrentPage(page);var params={_page:page,_limit:limit};if(!isAdmin){params=_objectSpread(_objectSpread({},params),{},{publish:true});console.log(params);}//axios.get('http://localhost:5000/board_test', {\n// axios.get( url +'/board_test?_page=&{page}&_limit={limit}')\naxios.get(url+'/board_test',{params:params}).then(function(res){//setNumberOfPosts(res.headers['x-total-count']); \n//console.log(params._limit);\n//console.log(res.data);\nsetNumberOfPosts(res.data.length);setPosts(res.data);setLoading(false);});};var deleteBlog=function deleteBlog(e,id){e.stopPropagation();// 상위계층의 클릭 이벤트를 막아줌(버블링을 막음)\n//console.log('delete blog');\n//console.log({id});      \n//axios.delete(url + \"/board_test\", {id}).then(()=>{\naxios.delete(url+\"/board_test/\".concat(id)).then(function(){setPosts(function(prevPosts){return prevPosts.filter(function(post){return post.id!==id;});});});};useEffect(function(){getPosts();},[]);if(loading){return/*#__PURE__*/_jsx(LoadingSpinner,{});}if(posts.length===0){return/*#__PURE__*/_jsx(\"div\",{children:\" No blog posts found \"});}var renderBlogList=function renderBlogList(){return posts.map(function(post){return/*#__PURE__*/_jsx(Card,{title:post.title,onClick:function onClick(){return history.push(\"/blogs/\".concat(post.id));},children:isAdmin?/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger btn-sm\",onClick:function onClick(e){return deleteBlog(e,post.id);}/* onClick = {(e) => {\r\n                    e.stopPropagation();\r\n                    console.log('HHS')\r\n                    }} */,children:\"  Delete\"})}):null},post.id);});};return/*#__PURE__*/_jsxs(\"div\",{children:[renderBlogList(),numberOfPages>1&&/*#__PURE__*/_jsx(Pagination,{currentPage:currentPage,numberOfPages:numberOfPages,onClick:getPosts})]});};BlogList.defaultProps={isAdmin:false};export default BlogList;","map":{"version":3,"names":["axios","useState","useEffect","Card","useHistory","Pagination","LoadingSpinner","BlogList","isAdmin","url","history","posts","setPosts","loading","setLoading","currentPage","setCurrentPage","numberOfPosts","setNumberOfPosts","numberOfPages","setNumberOfPages","limit","Math","ceil","getPosts","page","params","_page","_limit","publish","console","log","get","then","res","data","length","deleteBlog","e","id","stopPropagation","delete","prevPosts","filter","post","renderBlogList","map","title","push","defaultProps"],"sources":["C:/Users/PKNU/Documents/GitHub/travelbusanko/travelbusanko/src/components/BlogList.js"],"sourcesContent":["import axios from 'axios';\r\nimport { useState, useEffect } from 'react';\r\n//import { Link } from 'react-router-dom';\r\nimport Card from '../components/Card';\r\nimport { useHistory } from 'react-router';\r\n//import  LoadingSpinner  from '../components/LoadingSpinner';\r\nimport { bool } from 'prop-types';\r\nimport Pagination from './Pagination';\r\n//import Pagination2 from './Pagination2';\r\nimport LoadingSpinner  from './LoadingSpinner';\r\n\r\nconst BlogList = ({ isAdmin }) => {\r\n\r\n    const url = \"http://travelbusanko.com\"; \r\n    const history = useHistory();\r\n    const [posts, setPosts] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [currentPage, setCurrentPage] = useState(1);\r\n    const [numberOfPosts, setNumberOfPosts] = useState(0);\r\n    const [numberOfPages, setNumberOfPages] = useState(0);\r\n    const limit = 5;\r\n\r\n    useEffect(()=> {\r\n        setNumberOfPages(Math.ceil(numberOfPosts/limit));\r\n    }, [numberOfPosts]);\r\n\r\n    const getPosts = (page = 1) =>{\r\n        setCurrentPage(page);\r\n        let params = { \r\n            _page : page,\r\n            _limit : limit         \r\n        }\r\n  \r\n        if(!isAdmin){\r\n            params={...params, publish:true};\r\n            console.log(params);\r\n        }\r\n       \r\n        \r\n        //axios.get('http://localhost:5000/board_test', {\r\n        // axios.get( url +'/board_test?_page=&{page}&_limit={limit}')\r\n         axios.get( url +'/board_test', {       \r\n                 params                   \r\n         }).then((res) => {                    \r\n            //setNumberOfPosts(res.headers['x-total-count']); \r\n            //console.log(params._limit);\r\n            //console.log(res.data);\r\n            setNumberOfPosts(res.data.length);            \r\n            setPosts(res.data);\r\n            setLoading(false);\r\n        })\r\n    }\r\n\r\n    const deleteBlog = (e, id) => {\r\n      e.stopPropagation(); // 상위계층의 클릭 이벤트를 막아줌(버블링을 막음)\r\n      //console.log('delete blog');\r\n      //console.log({id});      \r\n      //axios.delete(url + \"/board_test\", {id}).then(()=>{\r\n       axios.delete(url + `/board_test/${id}`).then(()=>{\r\n        setPosts(prevPosts => prevPosts.filter(post => post.id !== id)\r\n        )\r\n        }); \r\n    };\r\n    \r\n    useEffect(()=>{\r\n        getPosts();\r\n    }, []); \r\n\r\n    if(loading ){\r\n        return (\r\n        <LoadingSpinner />\r\n        )\r\n    } \r\n    if (posts.length === 0) {\r\n        return (<div> No blog posts found </div>)\r\n    }\r\n\r\n    const renderBlogList= ()=>{\r\n        return posts.map(post => {       \r\n            return (\r\n                <Card key={post.id} \r\n                title={post.title} \r\n                onClick={ () => history.push(`/blogs/${post.id}`)} \r\n                >     \r\n                {isAdmin ? (<div>\r\n                    <button className=\"btn btn-danger btn-sm\"\r\n                    onClick={(e) =>  deleteBlog(e, post.id) }\r\n                    /* onClick = {(e) => {\r\n                    e.stopPropagation();\r\n                    console.log('HHS')\r\n                    }} */\r\n                    >  Delete\r\n                    </button>\r\n                </div>) : null}\r\n                </Card>    \r\n            ); \r\n        })    \r\n    }\r\n    return (\r\n    <div>\r\n       { renderBlogList() } \r\n     \r\n       {numberOfPages > 1 && <Pagination\r\n          currentPage= {currentPage} \r\n          numberOfPages = {numberOfPages} \r\n          \r\n          onClick={getPosts} \r\n        />}      \r\n    </div>\r\n    )\r\n};\r\n\r\nBlogList.propTypes = {\r\n  isAdmin: bool\r\n}\r\nBlogList.defaultProps = {\r\n  isAdmin: false\r\n};\r\nexport default BlogList;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}